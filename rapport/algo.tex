In the following we will consider two DAGs, each with a particular node called head. The head is such that every node in the considered DAG are ancestors of the head. One of the DAG is will be refered to as Client or $Bob$ and the other one as Server or $Alice$. $\mathrm{Ancestor}(Alice)$ and $\mathrm{Ancestor}(Bob)$ are the considered DAGs and the aim of the algorithm is to be able to compute $\mathrm{Ancestor}(Alice) \setminus \mathrm{Ancestor}(Bob) = \{ x\ ,\ x \in \mathrm{Ancestor}(Alice) \wedge x \notin \mathrm{Ancestor}(Bob)\}$. The complexity of the algorithm will be expressed in terms of $n = \#(\mathrm{Ancestor}(Alice) \setminus \mathrm{Ancestor}(Bob))$. In terms of application, the client and the server are two entities that are physically distinct, therefore it was important during the design of the algorithm to keep in mind and to be aware that :
\begin{itemize}
 \item The quantity of information exchanged between the two processes shall be the smaller possible
 \item We have to consider the complexity on both processes
 \item There can be no pre-computation of any form, because the shape of the global DAG (with multiple head) is evolving in time and is not known at the beginning.
 \item There is no high authority that has a memory of every thing.
\end{itemize}
\paragraph{} The previous section underlined that we were not able to find a way to compute easily the set of BCA, moreover if the server has to send the difference $\mathrm{Ancestor}(Alice) \setminus \mathrm{Ancestor}(Bob)$ then at some point we will have to go all over this difference at some point, therefore we decided that the server could cross the part of its history corresponding to the difference. However the server does not know what nodes are already in the history of the client. Hence the client need to send to the server its history so that the server knows when the exploration of its past shal stop. Sending all of the client's history can requiere a huge exchange of data, moreover in applications we are interested in (git) the difference we are trying to compute is usually small compared to the size of the all history. the client shall therefore only send the latest event in its history (a fixed number) so that in most case the server manages to make the link between the two histories. However in some cases the server will not be able to find any of the client's latest node in its history, in such cases the server will have to go throw all of its history (because the link can be anywhere) to understand that it has nothing in common with this set of latest nodes. We do not want the server to go throw all of its history as we have no bound on the size of this history. Thus the client need to tell the server that at some point of its exploration the server need to stop because there is no point in continuing the exploration. We introduce the Border of a set of nodes $A$ as defined such that for every nodes in $A$ each of its predecessor are either in $A$ or in the border of $A$. To sum up, the client divides its history in packages that will be called "window" and to each window we associate a "border" (see \ref{fig:twoproc}). Now if the client send a window and the union of all the borders to the server, this one will, at some point, find one of the two while exploring its history bottom-up and therefore will not have to go across all of its history.

\begin{figure}[H]
\centering
\begin{tikzpicture}
\begin{scope}
\coordinate (A) at (0,0);
\coordinate (B) at (4,10);
\coordinate (C) at (-4,10);
\draw [thick] (A) -- (B) coordinate[pos = 0.4] (B1) {} coordinate [pos = 0.42] (B1b) {} coordinate[pos = 0.7] (B2) {} coordinate[pos = 0.72] (B2b) {};
\draw [thick] (B) -- (C) coordinate[pos = 0.5] (midBC) {};
\draw [thick] (A) -- (C) coordinate[pos = 0.5] (C1) {} coordinate [pos = 0.52] (C1b) {} coordinate[pos = 0.8] (C2) {} coordinate[pos = 0.82] (C2b) {};
\draw [thick, fill = LimeGreen,fill opacity = 0.5] (A) -- (B1) .. controls (1,3) and (-1,7) .. (C1) -- (A);
\draw [thick, fill = green,fill opacity = 0.5] (B1) .. controls (1,3) and (-1,7) .. (C1) -- (C2) .. controls (-2,6) and (2,8) .. (B2) -- (B1);
\draw [thick, fill = ForestGreen, fill opacity = 0.5] (C2) .. controls (-2,6) and (2,8) .. (B2) -- (B) -- (C) -- (C2);
\draw [thick, fill = red, fill opacity = 1] (B1b) .. controls (1,3.1) and (-1,7.1) .. (C1b) -- (C1) .. controls (-1,7) and (1,3) .. (B1) -- (B1b);
\draw [thick, fill = red, fill opacity = 1] (C2) .. controls (-2,6) and (2,8) .. (B2) -- (B2b) .. controls (2,8.1) and (-2,6.1) .. (C2b) -- (C2);
\draw [draw = none] (A) -- (midBC) node[pos = 0.3] {$A_0$} node[pos = 0.6] {$A_1$} node[pos = 0.9] {$A_2$};

\end{scope}
\begin{scope}[shift={(4cm,0cm)}]
\coordinate (D) at (0,0);
\coordinate (E) at (4,10);
\coordinate (F) at (-4,10);
\draw [thick] (D) -- (E) coordinate[pos = 0.5] (E1) {} coordinate [pos = 0.52] (E1b) {} coordinate[pos = 0.8] (E2) {} coordinate[pos = 0.82] (E2b) {};
\draw [thick] (E) -- (F) coordinate[pos = 0.5] (midEF) {};
\draw [thick] (D) -- (F) coordinate[pos = 0.3] (F1) {} coordinate [pos = 0.32] (F1b) {} coordinate[pos = 0.6] (F2) {} coordinate[pos = 0.62] (F2b) {};
\draw [thick, fill = Cerulean,fill opacity = 0.5] (D) -- (E1) .. controls (1,3) and (-1,7) .. (F1) -- (D);
\draw [thick, fill = blue,fill opacity = 0.5] (E1) .. controls (1,3) and (-1,7) .. (F1) -- (F2) .. controls (-2,6) and (2,8) .. (E2) -- (E1);
\draw [thick, fill = SkyBlue, fill opacity = 0.5] (F2) .. controls (-2,6) and (2,8) .. (E2) -- (E) -- (F) -- (F2);
\draw [thick, fill = red, fill opacity = 1] (E1b) .. controls (1,3.1) and (-1,7.1) .. (F1b) -- (F1) .. controls (-1,7) and (1,3) .. (E1) -- (E1b);
\draw [thick, fill = red, fill opacity = 1] (F2) .. controls (-2,6) and (2,8) .. (E2) -- (E2b) .. controls (2,8.1) and (-2,6.1) .. (F2b) -- (F2);
\draw [draw = none] (D) -- (midEF) node[pos = 0.3] {$B_0$} node[pos = 0.6] {$B_1$} node[pos = 0.9] {$B_2$};
\end{scope}
\end{tikzpicture}
\caption{Two processes sharing a part of their history and their decomposition in Windows and Borders} \label{fig:twoproc}
\end{figure}

\begin{algorithm}[H]
  \SetAlgoLined
  \caption{Finding some of the ancestors of $Alice$ not known by $Bob$}
  \SetKwInOut{Input}{input}\SetKwInOut{Output}{output}
  \SetKwComment{tcc}{(*}{*)}
  \KwData{\texttt{Alice\_Heads} : some nodes in the history of $Alice$, \texttt{Ancestor} : a dag of the ancesters of $Alice$, \texttt{G\_In} : a graph of ancestors of $Alice$ not known by $Bob$, \texttt{Bf} : The Bloom filter of $Bob$, \texttt{Bd} : The Border of $Bob$}
%   \KwData{
%     \begin{itemize}
%     \item \texttt{Alice\_Heads} : some nodes in the history of $Alice$
%     \item \texttt{Ancestor} : a dag of the ancesters of $Alice$
%     \item \texttt{G\_In} : a graph of ancestors of $Alice$ not known by $Bob$
%     \item \texttt{Bf} : The Bloom filter of $Bob$
%     \item \texttt{Bd} : The Border of $Bob$
%     \end{itemize}
%     }
  \KwResult{\texttt{G\_Out} : a graph of ancestors of $Alice$ not known by $Bob$, \texttt{node\_to\_check} : a list of ancestors of $Alice$ that shall be revisited with the next Bloomfilters}
%   \KwResult{
%   \begin{itemize}
%   \item \texttt{G\_Out} : a graph of ancestors of $Alice$ not known by $Bob$
%   \item \texttt{node\_to\_check} : a list of ancestors of $Alice$ that shall be revisited with the next Bloomfilters
%   \end{itemize}
%   }
  
\SetAlgoLined\DontPrintSemicolon
\SetKwFunction{explore}{\textbf{explore}}
\SetKwFunction{belong}{\textbf{belong}}
\SetKwFunction{addv}{\textbf{add\_vertex}}
\SetKwFunction{adde}{\textbf{add\_edge}}
\SetKwFunction{succ}{\textbf{successor}}
\SetKwFunction{pred}{\textbf{predecessor}}
\SetKwProg{myproc}{Procedure}{}{}
\myproc{\explore{\texttt{node},\texttt{visited},\texttt{in\_bf},\texttt{in\_border}}}{

  \eIf{\belong{\texttt{node,\texttt{Bf}}}}{
    \KwRet{(\texttt{visited} $\cup$ \texttt{node},\texttt{in\_bf} $\cup$ \texttt{node},\texttt{in\_border})}
  }
  {
    \eIf{\belong{\texttt{node,\texttt{Bd}}}}{
    \KwRet{(\texttt{visited} $\cup$ \texttt{node},\texttt{in\_bf} ,\texttt{in\_border}$\cup$ \texttt{node})}
    }
    {
      \texttt{visited\_already} = \texttt{node} $\cup$ \texttt{visited}\;
      \texttt{in\_bf\_already} = \texttt{in\_bf}\;				
      \texttt{in\_border\_already} = \texttt{in\_border}\;
      \For{\texttt{pere} $\in$ \pred{\texttt{Ancestor},\texttt{node}}}{
      \If{\texttt{pere} $\notin$ \texttt{explored}}
      {
	\texttt{visited\_already,in\_bf\_already,in\_border\_already} = \explore{\texttt{pere},\texttt{visited\_already},\texttt{in\_bf\_already},\texttt{in\_border\_already}}\;
      }
      }
      \KwRet{(\texttt{visited\_already},\texttt{in\_bf\_already},\texttt{in\_border\_already})}\;
    }	
  }
}

\SetKwFunction{bf}{\textbf{find\_in\_bf}}
\SetKwFunction{bd}{\textbf{find\_in\_border}}
\myproc{\bf{\texttt{node},\texttt{explored}}}{
    \addv{\texttt{G\_In},\texttt{node}}\;
    \texttt{already\_explored} = \texttt{explored} $\cup$ \texttt{node}\;
    \For{\texttt{fils} $\in$ \succ{\texttt{Ancestor},\texttt{node}}}{
      \adde{\texttt{G\_In},\texttt{node},\texttt{fils}}\;
      \If{$\texttt{fils} \notin \texttt{already\_explored} \wedge \texttt{fils} \notin \texttt{G\_In}$}{
	\texttt{already\_explored} = \bf{\texttt{fils},\texttt{already\_explored}}
	}
    }
    \KwRet{already\_explored}
}

\myproc{\bd{\texttt{node},\texttt{explored},\texttt{to\_further\_explore}}}{
  \If{$\texttt{node} \notin \texttt{explored}$}{
    \texttt{son\_in} = $\varnothing$\;
    \texttt{son\_out} = $\varnothing$\;
    \For{\texttt{fils} $\in$ \succ{\texttt{Ancestor},\texttt{node}}}{
      \eIf{\texttt{fils} $\in$ \texttt{G\_In}}{
	\texttt{son\_in} = \texttt{fils} $\cup$ \texttt{son\_in}\; 
      }{
	\texttt{son\_out} = \texttt{fils} $\cup$ \texttt{son\_out}\;
      }
    }
    \texttt{already\_explored} = \texttt{explored}\;
    \texttt{inter\_node} = \texttt{to\_further\_explore}\;
    \If{\texttt{son\_in} = $\varnothing$}{
      \texttt{inter\_node} = \texttt{node} $\cup$ \texttt{inter\_node}\;
    }
    \For{\texttt{fils} $\in$ \texttt{son\_out}}{
      \If{\texttt{fils} $\notin$ \texttt{already\_explored}}{
	\texttt{already\_explored},\texttt{inter\_node} = \bd{\texttt{fils},\texttt{already\_explored},\texttt{inter\_node}}\;
      }
    }
    \KwRet{(already\_explored,inter\_node)}\;
  }
}
\end{algorithm}
  \begin{algorithm}
  \SetAlgoLined
  \caption{Finding some of the ancestors of $Alice$ not known by $Bob$}
  \SetKwInOut{Input}{input}\SetKwInOut{Output}{output}
  \SetKwComment{tcc}{(*}{*)}
  \KwData{\texttt{Alice\_Heads} : some nodes in the history of $Alice$, \texttt{Ancestor} : a dag of the ancesters of $Alice$, \texttt{G\_In} : a graph of ancestors of $Alice$ not known by $Bob$, \texttt{Bf} : The Bloom filter of $Bob$, \texttt{Bd} : The Border of $Bob$}
%   \KwData{
%     \begin{itemize}
%     \item \texttt{Alice\_Heads} : some nodes in the history of $Alice$
%     \item \texttt{Ancestor} : a dag of the ancesters of $Alice$
%     \item \texttt{G\_In} : a graph of ancestors of $Alice$ not known by $Bob$
%     \item \texttt{Bf} : The Bloom filter of $Bob$
%     \item \texttt{Bd} : The Border of $Bob$
%     \end{itemize}
%     }
  \KwResult{\texttt{G\_Out} : a graph of ancestors of $Alice$ not known by $Bob$, \texttt{node\_to\_check} : a list of ancestors of $Alice$ that shall be revisited with the next Bloomfilters}
%   \KwResult{
%   \begin{itemize}
%   \item \texttt{G\_Out} : a graph of ancestors of $Alice$ not known by $Bob$
%   \item \texttt{node\_to\_check} : a list of ancestors of $Alice$ that shall be revisited with the next Bloomfilters
%   \end{itemize}
%   }
  
\SetAlgoLined\DontPrintSemicolon

  \texttt{explored} = $\varnothing$\;
  \texttt{in\_bf} = $\varnothing$\;
  \texttt{in\_border} = $\varnothing$\;
  \texttt{to\_further\_explore} = $\varnothing$\;
\SetKwFunction{explore}{\textbf{explore}}
\SetKwFunction{belong}{\textbf{belong}}
\SetKwFunction{addv}{\textbf{add\_vertex}}
\SetKwFunction{adde}{\textbf{add\_edge}}
\SetKwFunction{succ}{\textbf{successor}}
\SetKwFunction{pred}{\textbf{predecessor}}
\SetKwProg{myproc}{Procedure}{}{}
\myproc{\explore{\texttt{node}}}{

\If{\texttt{node} $\notin$ \texttt{explored}}
{
\texttt{explored} = \texttt{node} $\cup$ \texttt{explored}\;
\eIf{\belong{\texttt{node,\texttt{Bf}}}}{
  \texttt{in\_bf} = \texttt{node} $\cup$ \texttt{in\_bf}\;
  }
  {
  \eIf{\belong{\texttt{node,\texttt{Bd}}}}{
  \texttt{in\_border} = \texttt{node} $\cup$ \texttt{in\_border}\;
  }
  {
  \For{\texttt{pere} $\in$ \pred{\texttt{Ancestor},\texttt{node}}}{
    \explore{\texttt{pere}}
  }
  }
  }
}
}
\SetKwFunction{bf}{\textbf{find\_in\_bf}}
\SetKwFunction{bd}{\textbf{find\_in\_border}}
\myproc{\bf{\texttt{node}}}{
  \If{$\texttt{node} \notin \texttt{explored} \wedge \texttt{node} \notin \texttt{G\_In}$}{
    \addv{\texttt{G\_In},\texttt{node}}\;
    \For{\texttt{fils} $\in$ \succ{\texttt{Ancestor},\texttt{node}}}{
      \adde{\texttt{G\_In},\texttt{node},\texttt{fils}}\;
      \bf{\texttt{fils}}
    }
  }
}
\myproc{\bd{\texttt{node}}}{
  \If{$\texttt{node} \notin \texttt{explored}$}{
    \eIf{$\texttt{node} \in \texttt{G\_In}$}{
      \texttt{to\_further\_explore} = \texttt{node} $\cup$ \texttt{to\_further\_explore}\;
    }
    {
      \For{\texttt{fils} $\in$ \succ{\texttt{Ancestor},\texttt{node}}}{
      \bd{\texttt{fils}}
      }    
    }
  }
}
\For{\texttt{node} $\in$ \texttt{Alice\_Heads}}{
  \explore{\texttt{node}}
}
\texttt{explored} = $\varnothing$\;
\For{\texttt{node} $\in$ \texttt{in\_bf}}{
  \bf{\texttt{node}}
}
\texttt{explored} = $\varnothing$\;
\For{\texttt{node} $\in$ \texttt{in\_border}}{
  \bd{\texttt{node}}
}
\KwRet{(\texttt{G\_In,to\_further\_explore})}
  
  \end{algorithm}
  
  \begin{figure}[H]
  \begin{minipage}{0.3\textwidth}
  \centering
  \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]
  
  \foreach \place/\x in {{(0,0)/1}, {(0,1)/2},{(0,2)/3},{(0,3)/4}, {(1,4.5)/5}, {(2,1)/6}, {(1.5,2)/7},{(2.5,2)/8},{(1,3)/9},{(2,3)/10},{(3,3)/11},{(2,4)/12},{(2,5)/13},{(2,6)/14}}
  \node[arn_n] (a\x) at \place {\x};
%   Alice history
  \path[thin] (a14) edge (a5);
  \path[thin] (a5) edge (a4);
  \path[thin] (a4) edge (a3);
  \path[thin] (a3) edge (a2);
  \path[thin] (a2) edge (a1);
  \path[thin] (a9) edge (a4);
  \path[thin] (a7) edge (a2);
%   both history
  \path[thin] (a14) edge (a13);
  \path[thin] (a13) edge (a12);
  \path[thin] (a12) edge (a9);
  \path[thin] (a12) edge (a10);
  
  \path[thin] (a9) edge (a7);
  \path[thin] (a10) edge (a7);
%   Bob history
  \path[thin] (a12) edge (a11);
  \path[thin] (a11) edge (a8);
  \path[thin] (a10) edge (a8);
  \path[thin] (a7) edge (a6);
  \path[thin] (a8) edge (a6);
  \end{tikzpicture}
  \caption{Main Graph}
  \end{minipage}%
  \begin{minipage}{0.3\textwidth}
  \centering
  \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]
  \foreach \place/\x in {{(0,0)/1}, {(0,1)/2}}
  \node[arn_g] (a\x) at \place {\x};
  
  
  \node[arn_pis] (a5) at (1,4.5) {5};
  \node[arn_pis] (a13) at (2,5) {13};
  \node[arn_pis] (a14) at (2,6) {14};
  
  
  \node[arn_b] (a10) at (2,3) {10};
  \node[arn_b] (a7) at (1.5,2) {7};
  \node[arn_bs] (a3) at (0,2) {3};
  
  \node[arn_rs] (a9) at (1,3) {9};
  \node[arn_rs] (a12) at (2,4) {12};
  \node[arn_rs] (a4) at (0,3) {4};
  %   Alice history
  \path[thin] (a14) edge (a5);
  \path[thin] (a5) edge (a4);
  \path[thin] (a4) edge (a3);
  \path[thin] (a3) edge (a2);
  \path[thin] (a2) edge (a1);
  \path[thin] (a9) edge (a4);
  \path[thin] (a7) edge (a2);
%   both history
  \path[thin] (a14) edge (a13);
  \path[thin] (a13) edge (a12);
  \path[thin] (a12) edge (a9);
  \path[thin] (a12) edge (a10);
  
  \path[thin] (a9) edge (a7);
  \path[thin] (a10) edge (a7);
  \end{tikzpicture}
  \caption{Alice's ancestors}
\end{minipage}%
\begin{minipage}{0.3\textwidth}
\centering
  \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]
%   
  \node[arn_y] (a6) at (2,1) {6};
  \node[arn_y] (a7) at (1.5,2) {7};
  \node[arn_y] (a8) at (2.5,2) {8};
  \node[arn_ts] (a9) at (1,3) {9};
  \node[arn_ts] (a10) at (2,3) {10};
  \node[arn_ts] (a11) at (3,3) {11};
  \node[arn_pus] (a12) at (2,4) {12};
  \node[arn_pu] (a13) at (2,5) {13};
  \node[arn_pus] (a14) at (2,6) {14};
  
%   both history
  \path[thin] (a14) edge (a13);
  \path[thin] (a13) edge (a12);
  \path[thin] (a12) edge (a9);
  \path[thin] (a12) edge (a10);
  
  \path[thin] (a9) edge (a7);
  \path[thin] (a10) edge (a7);
%   Bob history
  \path[thin] (a12) edge (a11);
  \path[thin] (a11) edge (a8);
  \path[thin] (a10) edge (a8);
  \path[thin] (a7) edge (a6);
  \path[thin] (a8) edge (a6);
  \end{tikzpicture}
  \caption{Bob's ancestors}

\end{minipage}
\end{figure}

\begin{figure}[H]
\begin{minipage}{0.3\textwidth}
\centering
 \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]
  
  
  
  \node[arn_r] (a1) at (0,0) {1};
  \node[arn_r] (a2) at (0,1) {2};
  
  \node[arn_r] (a5) at (1,4.5) {5};
  \node[arn_n] (a13) at (2,5) {13};
  \node[arn_rs] (a14) at (2,6) {14};
  
  
  \node[arn_n] (a10) at (2,3) {10};
  \node[arn_y] (a7) at (1.5,2) {7};
  \node[arn_r] (a3) at (0,2) {3};
  
  \node[arn_rs] (a9) at (1,3) {9};
  \node[arn_n] (a12) at (2,4) {12};
  \node[arn_r] (a4) at (0,3) {4};
  
  %   Alice history
  \path[thin] (a14) edge (a5);
  \path[thin] (a5) edge (a4);
  \path[thin] (a4) edge (a3);
  \path[thin] (a3) edge (a2);
  \path[thin] (a2) edge (a1);
  \path[thin] (a9) edge (a4);
  \path[thin] (a7) edge (a2);
%   both history
  \path[thin] (a14) edge (a13);
  \path[thin] (a13) edge (a12);
  \path[thin] (a12) edge (a9);
  \path[thin] (a12) edge (a10);
  
  \path[thin] (a9) edge (a7);
  \path[thin] (a10) edge (a7);
  \end{tikzpicture}
  \caption*{[1] Explore}
\end{minipage}
\begin{minipage}{0.3\textwidth}
\centering
 \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]
  
  
  
  \node[arn_b] (a1) at (0,0) {1};
  \node[arn_b] (a2) at (0,1) {2};
  
  \node[arn_n] (a5) at (1,4.5) {5};
  \node[arn_n] (a13) at (2,5) {13};
  \node[arn_rs] (a14) at (2,6) {14};
  
  
  \node[arn_n] (a10) at (2,3) {10};
  \node[arn_b] (a7) at (1.5,2) {7};
  \node[arn_n] (a3) at (0,2) {3};
  
  \node[arn_rs] (a9) at (1,3) {9};
  \node[arn_n] (a12) at (2,4) {12};
  \node[arn_n] (a4) at (0,3) {4};
  
  %   Alice history
  \path[thin] (a14) edge (a5);
  \path[thin] (a5) edge (a4);
  \path[thin] (a4) edge (a3);
  \path[thin] (a3) edge (a2);
  \path[thin] (a2) edge (a1);
  \path[thin] (a9) edge (a4);
  \path[thin] (a7) edge (a2);
%   both history
  \path[thin] (a14) edge (a13);
  \path[thin] (a13) edge (a12);
  \path[thin] (a12) edge (a9);
  \path[thin] (a12) edge (a10);
  
  \path[thin] (a9) edge (a7);
  \path[thin] (a10) edge (a7);
  \end{tikzpicture}
  \caption{deal with bloomfilters}
\end{minipage}
 \begin{minipage}{0.3\textwidth}
 \centering
 \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]
  
  

  \node[arn_rb] (emph) at (0,2) {};
  \node[arn_b] (a1) at (0,0) {1};
  \node[arn_b] (a2) at (0,1) {2};
  
  \node[arn_n] (a5) at (1,4.5) {5};
  \node[arn_n] (a13) at (2,5) {13};
  \node[arn_n] (a14) at (2,6) {14};
  
  
  \node[arn_n] (a10) at (2,3) {10};
  \node[arn_b] (a7) at (1.5,2) {7};
  \node[arn_b] (a3) at (0,2) {3};
  
  \node[arn_n] (a9) at (1,3) {9};
  \node[arn_n] (a12) at (2,4) {12};
  \node[arn_n] (a4) at (0,3) {4};
%   \node[cloud, fill=gray!20, cloud puffs=16, cloud puff arc= 100,minimum width=2em, minimum height=2em, aspect=1] (cloud) at (5,2) {};

  %   Alice history
  \path[thin] (a14) edge (a5);
  \path[thin] (a5) edge (a4);
  \path[thin] (a4) edge (a3);
  \path[thin] (a3) edge (a2);
  \path[thin] (a2) edge (a1);
  \path[thin] (a9) edge (a4);
  \path[thin] (a7) edge (a2);
%   both history
  \path[thin] (a14) edge (a13);
  \path[thin] (a13) edge (a12);
  \path[thin] (a12) edge (a9);
  \path[thin] (a12) edge (a10);
  
  \path[thin] (a9) edge (a7);
  \path[thin] (a10) edge (a7);
  \end{tikzpicture}
  \caption{deal with border}
\end{minipage}
\end{figure}
\begin{figure}[H]
  \begin{minipage}{0.3\textwidth}
  \centering
 \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]
  
  
  \node[arn_n] (a1) at (0,0) {1};
  \node[arn_n] (a2) at (0,1) {2};
  
  \node[arn_r] (a5) at (1,4.5) {5};
  \node[arn_n] (a13) at (2,5) {13};
  \node[arn_rs] (a14) at (2,6) {14};
  
  
  \node[arn_n] (a10) at (2,3) {10};
  \node[arn_n] (a7) at (1.5,2) {7};
  \node[arn_r] (a3) at (0,2) {3};
  
  \node[arn_t] (a9) at (1,3) {9};
  \node[arn_n] (a12) at (2,4) {12};
  \node[arn_r] (a4) at (0,3) {4};
%   \node[cloud, fill=gray!20, cloud puffs=16, cloud puff arc= 100,minimum width=2em, minimum height=2em, aspect=1] (cloud) at (5,2) {};

  %   Alice history
  \path[thin] (a14) edge (a5);
  \path[thin] (a5) edge (a4);
  \path[thin] (a4) edge (a3);
  \path[thin] (a3) edge (a2);
  \path[thin] (a2) edge (a1);
  \path[thin] (a9) edge (a4);
  \path[thin] (a7) edge (a2);
%   both history
  \path[thin] (a14) edge (a13);
  \path[thin] (a13) edge (a12);
  \path[thin] (a12) edge (a9);
  \path[thin] (a12) edge (a10);
  
  \path[thin] (a9) edge (a7);
  \path[thin] (a10) edge (a7);
  \end{tikzpicture}
  \caption{explore}
\end{minipage}
\begin{minipage}{0.3\textwidth}
  \centering
 \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]
  
  
  \node[arn_n] (a1) at (0,0) {1};
  \node[arn_n] (a2) at (0,1) {2};
  
  \node[arn_n] (a5) at (1,4.5) {5};
  \node[arn_n] (a13) at (2,5) {13};
  \node[arn_rs] (a14) at (2,6) {14};
  
  
  \node[arn_n] (a10) at (2,3) {10};
  \node[arn_n] (a7) at (1.5,2) {7};
  \node[arn_b] (a3) at (0,2) {3};
  
  \node[arn_b] (a9) at (1,3) {9};
  \node[arn_n] (a12) at (2,4) {12};
  \node[arn_b] (a4) at (0,3) {4};
%   \node[cloud, fill=gray!20, cloud puffs=16, cloud puff arc= 100,minimum width=2em, minimum height=2em, aspect=1] (cloud) at (5,2) {};

  %   Alice history
  \path[thin] (a14) edge (a5);
  \path[thin] (a5) edge (a4);
  \path[thin] (a4) edge (a3);
  \path[thin] (a3) edge (a2);
  \path[thin] (a2) edge (a1);
  \path[thin] (a9) edge (a4);
  \path[thin] (a7) edge (a2);
%   both history
  \path[thin] (a14) edge (a13);
  \path[thin] (a13) edge (a12);
  \path[thin] (a12) edge (a9);
  \path[thin] (a12) edge (a10);
  
  \path[thin] (a9) edge (a7);
  \path[thin] (a10) edge (a7);
  \end{tikzpicture}
  \caption{deal with bloomfilters}
\end{minipage}
\begin{minipage}{0.3\textwidth}
  \centering
 \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]
  
  \node[arn_rb] (emph) at (1,4.5) {};
  \node[arn_n] (a1) at (0,0) {1};
  \node[arn_n] (a2) at (0,1) {2};
  
  \node[arn_b] (a5) at (1,4.5) {5};
  \node[arn_n] (a13) at (2,5) {13};
  \node[arn_n] (a14) at (2,6) {14};
  
  
  \node[arn_n] (a10) at (2,3) {10};
  \node[arn_n] (a7) at (1.5,2) {7};
  \node[arn_b] (a3) at (0,2) {3};
  
  \node[arn_b] (a9) at (1,3) {9};
  \node[arn_n] (a12) at (2,4) {12};
  \node[arn_b] (a4) at (0,3) {4};
%   \node[cloud, fill=gray!20, cloud puffs=16, cloud puff arc= 100,minimum width=2em, minimum height=2em, aspect=1] (cloud) at (5,2) {};

  %   Alice history
  \path[thin] (a14) edge (a5);
  \path[thin] (a5) edge (a4);
  \path[thin] (a4) edge (a3);
  \path[thin] (a3) edge (a2);
  \path[thin] (a2) edge (a1);
  \path[thin] (a9) edge (a4);
  \path[thin] (a7) edge (a2);
%   both history
  \path[thin] (a14) edge (a13);
  \path[thin] (a13) edge (a12);
  \path[thin] (a12) edge (a9);
  \path[thin] (a12) edge (a10);
  
  \path[thin] (a9) edge (a7);
  \path[thin] (a10) edge (a7);
  \end{tikzpicture}
  \caption{deal with borders}
\end{minipage}
\end{figure}
\begin{figure}[H]
 
\begin{minipage}{0.3\textwidth}
  \centering
 \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]
  
  
  \node[arn_n] (a1) at (0,0) {1};
  \node[arn_n] (a2) at (0,1) {2};
  
  \node[arn_r] (a5) at (1,4.5) {5};
  \node[arn_n] (a13) at (2,5) {13};
  \node[arn_pu] (a14) at (2,6) {14};
  
  
  \node[arn_n] (a10) at (2,3) {10};
  \node[arn_n] (a7) at (1.5,2) {7};
  \node[arn_n] (a3) at (0,2) {3};
  
  \node[arn_n] (a9) at (1,3) {9};
  \node[arn_n] (a12) at (2,4) {12};
  \node[arn_n] (a4) at (0,3) {4};
%   \node[cloud, fill=gray!20, cloud puffs=16, cloud puff arc= 100,minimum width=2em, minimum height=2em, aspect=1] (cloud) at (5,2) {};

  %   Alice history
  \path[thin] (a14) edge (a5);
  \path[thin] (a5) edge (a4);
  \path[thin] (a4) edge (a3);
  \path[thin] (a3) edge (a2);
  \path[thin] (a2) edge (a1);
  \path[thin] (a9) edge (a4);
  \path[thin] (a7) edge (a2);
%   both history
  \path[thin] (a14) edge (a13);
  \path[thin] (a13) edge (a12);
  \path[thin] (a12) edge (a9);
  \path[thin] (a12) edge (a10);
  
  \path[thin] (a9) edge (a7);
  \path[thin] (a10) edge (a7);
  \end{tikzpicture}
  \caption{explore}
\end{minipage}
\begin{minipage}{0.3\textwidth}
  \centering
 \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]
  
  
  \node[arn_n] (a1) at (0,0) {1};
  \node[arn_n] (a2) at (0,1) {2};
  
  \node[arn_b] (a5) at (1,4.5) {5};
  \node[arn_n] (a13) at (2,5) {13};
  \node[arn_b] (a14) at (2,6) {14};
  
  
  \node[arn_n] (a10) at (2,3) {10};
  \node[arn_n] (a7) at (1.5,2) {7};
  \node[arn_n] (a3) at (0,2) {3};
  
  \node[arn_n] (a9) at (1,3) {9};
  \node[arn_n] (a12) at (2,4) {12};
  \node[arn_n] (a4) at (0,3) {4};
%   \node[cloud, fill=gray!20, cloud puffs=16, cloud puff arc= 100,minimum width=2em, minimum height=2em, aspect=1] (cloud) at (5,2) {};

  %   Alice history
  \path[thin] (a14) edge (a5);
  \path[thin] (a5) edge (a4);
  \path[thin] (a4) edge (a3);
  \path[thin] (a3) edge (a2);
  \path[thin] (a2) edge (a1);
  \path[thin] (a9) edge (a4);
  \path[thin] (a7) edge (a2);
%   both history
  \path[thin] (a14) edge (a13);
  \path[thin] (a13) edge (a12);
  \path[thin] (a12) edge (a9);
  \path[thin] (a12) edge (a10);
  
  \path[thin] (a9) edge (a7);
  \path[thin] (a10) edge (a7);
  \end{tikzpicture}
  \caption{deal with bloomfilters}
\end{minipage}
\begin{minipage}{0.3\textwidth}
  \centering
 \begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]
  
  
  \node[arn_n] (a1) at (0,0) {1};
  \node[arn_n] (a2) at (0,1) {2};
  
  \node[arn_b] (a5) at (1,4.5) {5};
  \node[arn_n] (a13) at (2,5) {13};
  \node[arn_b] (a14) at (2,6) {14};
  
  
  \node[arn_n] (a10) at (2,3) {10};
  \node[arn_n] (a7) at (1.5,2) {7};
  \node[arn_n] (a3) at (0,2) {3};
  
  \node[arn_n] (a9) at (1,3) {9};
  \node[arn_n] (a12) at (2,4) {12};
  \node[arn_n] (a4) at (0,3) {4};
%   \node[cloud, fill=gray!20, cloud puffs=16, cloud puff arc= 100,minimum width=2em, minimum height=2em, aspect=1] (cloud) at (5,2) {};

  %   Alice history
  \path[thin] (a14) edge (a5);
  \path[thin] (a5) edge (a4);
  \path[thin] (a4) edge (a3);
  \path[thin] (a3) edge (a2);
  \path[thin] (a2) edge (a1);
  \path[thin] (a9) edge (a4);
  \path[thin] (a7) edge (a2);
%   both history
  \path[thin] (a14) edge (a13);
  \path[thin] (a13) edge (a12);
  \path[thin] (a12) edge (a9);
  \path[thin] (a12) edge (a10);
  
  \path[thin] (a9) edge (a7);
  \path[thin] (a10) edge (a7);
  \end{tikzpicture}
  \caption{deal with borders}
\end{minipage}
\end{figure}